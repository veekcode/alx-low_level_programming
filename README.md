the main C tasking is here
